<!-- src/app/components/mensajes/nueva-conversacion/nueva-conversacion.component.html -->
<div class="nueva-conversacion-container">
  <!-- Header -->
  <div class="nueva-conversacion-header">
    <button class="btn-back" (click)="volver()" title="Volver">
      â†
    </button>
    <h1>Nueva ConversaciÃ³n</h1>
    <button class="btn-icon" (click)="recargar()" title="Recargar">
      ğŸ”„
    </button>
  </div>

  <!-- Barra de bÃºsqueda -->
  <div class="search-bar">
    <div class="search-input-wrapper">
      <span class="search-icon">ğŸ”</span>
      <input
        type="text"
        class="search-input"
        [(ngModel)]="busqueda"
        (ngModelChange)="filtrarContactos()"
        placeholder="Buscar contacto..."
      />
      <button 
        *ngIf="busqueda" 
        class="clear-btn" 
        (click)="limpiarBusqueda()"
        title="Limpiar bÃºsqueda"
      >
        âœ•
      </button>
    </div>
  </div>

  <!-- Contenido principal -->
  <div class="nueva-conversacion-content">
    <!-- Loading -->
    <div *ngIf="cargando" class="loading-container">
      <div class="loading-spinner"></div>
      <p>Cargando contactos...</p>
    </div>

    <!-- Error -->
    <div *ngIf="error && !cargando" class="error-container">
      <span class="error-icon">âš ï¸</span>
      <p>{{ error }}</p>
      <button class="btn-primary" (click)="recargar()">Reintentar</button>
    </div>

    <!-- Sin contactos -->
    <div *ngIf="!cargando && !error && contactosFiltrados.length === 0" class="empty-container">
      <div class="empty-icon">ğŸ‘¥</div>
      <h2>{{ busqueda ? 'Sin resultados' : 'No hay contactos disponibles' }}</h2>
      <p>{{ busqueda ? 'Intenta con otra bÃºsqueda' : 'No tienes contactos para iniciar una conversaciÃ³n' }}</p>
    </div>

    <!-- Lista de contactos -->
    <div *ngIf="!cargando && !error && contactosFiltrados.length > 0" class="contactos-lista">
      <div 
        *ngFor="let contacto of contactosFiltrados"
        class="contacto-item"
        (click)="iniciarConversacion(contacto)"
      >
        <!-- Avatar -->
        <div class="avatar-container">
          <img 
            *ngIf="contacto.foto_url"
            [src]="contacto.foto_url"
            [alt]="obtenerNombreCompleto(contacto)"
            class="avatar"
            (error)="onImageError($event)"
          />
          <div *ngIf="!contacto.foto_url" class="avatar avatar-placeholder">
            {{ obtenerIniciales(contacto) }}
          </div>
        </div>

        <!-- InformaciÃ³n del contacto -->
        <div class="contacto-info">
          <h3 class="nombre">{{ obtenerNombreCompleto(contacto) }}</h3>
          <p class="rol" *ngIf="contacto.rol">
            {{ contacto.rol === 'cliente' ? 'ğŸ‘¤ Cliente' : 'ğŸ’ª Entrenador' }}
          </p>
          <p class="email" *ngIf="contacto.email">{{ contacto.email }}</p>
        </div>

        <!-- Icono de acciÃ³n -->
        <div class="contacto-action">
          <span class="icon-chat">ğŸ’¬</span>
        </div>
      </div>
    </div>
  </div>
</div>