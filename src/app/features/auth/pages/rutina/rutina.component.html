<div class="rutina-wrapper">
  <!-- ===== ENCABEZADO ===== -->
  <div class="rutina-header">
    <div>
      <h1>Mis Rutinas</h1>
      <p>Consulta tus entrenamientos personalizados generados por tu entrenador o IA</p>
    </div>

    <div class="filtros">
      <label for="semana">Semana:</label>
      <input
        id="semana"
        type="week"
        [(ngModel)]="semanaSeleccionada"
        (change)="filtrarPorSemana()"
      />
      <button [disabled]="!idAlumno" (click)="cargarRutina(idAlumno!)">
        <i class="fa-solid fa-rotate-right"></i> Actualizar
      </button>
    </div>
  </div>

  <!-- ===== ESTADOS ===== -->
  <div *ngIf="cargando" class="estado loading">
    <div class="spinner"></div>
    <p>Cargando rutinas...</p>
  </div>

  <div *ngIf="error && !cargando" class="estado error">
    <p>{{ error }}</p>
  </div>

  <!-- ===== LISTA DE RUTINAS ===== -->
  <div *ngIf="!cargando && rutinaFiltrada.length > 0" class="rutina-lista">
    <div *ngFor="let rutina of rutinaFiltrada" class="rutina-card fade-in">
      <div class="card-header">
        <div class="titulo-dia">
          <h2>{{ rutina.nombre | titlecase }}</h2>
          <span class="fecha">{{ rutina.fecha_creacion | date: 'EEEE, dd/MM/yyyy' }}</span>
        </div>
        <p class="descripcion">{{ rutina.descripcion }}</p>
        <div class="info">
          <span>Objetivo: {{ rutina.objetivo }}</span>
          <span>Nivel: {{ rutina.nivel }}</span>
          <span>DÃ­as: {{ rutina.dias_semana }}</span>
        </div>
      </div>

      <!-- ===== DÃAS ===== -->
      <div *ngFor="let dia of rutina.dias" class="dia-section fade-up">
        <div class="dia-header">
          <div class="barra-dia"></div>
          <h3 class="nombre-dia">ðŸ’ª {{ dia.nombre_dia | titlecase }}</h3>
          <p class="desc-dia">{{ dia.descripcion }}</p>
        </div>

        <ul class="ejercicios-lista">
          <li *ngFor="let ejercicio of dia.ejercicios">
            <div class="ejercicio-info">
              <strong>{{ ejercicio.nombre }}</strong>
              <small>{{ ejercicio.grupo_muscular || 'General' }} â€¢ {{ ejercicio.dificultad || 'N/A' }}</small>
            </div>
            <div class="detalles">
              <span *ngIf="ejercicio.series">{{ ejercicio.series }}Ã—</span>
              <span *ngIf="ejercicio.repeticiones">{{ ejercicio.repeticiones }}</span>
              <span *ngIf="ejercicio.descanso_segundos"> | Descanso: {{ ejercicio.descanso_segundos }}s</span>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- ===== SIN DATOS ===== -->
  <div *ngIf="!cargando && rutinaFiltrada.length === 0 && !error" class="estado sin-datos">
    <h3>No tienes rutinas registradas para esta semana</h3>
    <p>Tu entrenador asignarÃ¡ tus ejercicios prÃ³ximamente.</p>
  </div>
</div>
