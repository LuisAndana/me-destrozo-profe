<div class="app" [class.menu-open]="menuOpen" [class.collapsed]="collapsed">
  <!-- BOT칍N FLECHA -->
  <button
    type="button"
    class="rail-toggle"
    (click)="toggleCollapse()"
    [attr.aria-label]="collapsed ? 'Expandir men칰' : 'Colapsar men칰'">
    <span class="chev" [class.right]="collapsed"></span>
  </button>

  <!-- ===== SIDEBAR ===== -->
  <aside
    class="sidebar"
    role="navigation"
    aria-label="Men칰"
    [attr.aria-hidden]="collapsed && !menuOpen ? 'true' : null">

    <!-- 游댳 Bloque de usuario -->
    <a
      class="brand user-link user-entry"
      routerLink="/perfil"
      routerLinkActive="active"
      role="link"
      aria-label="Abrir perfil de usuario">
      
      <div class="avatar">
        <!-- Si el usuario tiene foto -->
        <img
          *ngIf="fotoUrl && fotoUrl.trim() !== ''"
          [src]="fotoUrl"
          alt="Foto de perfil"
          width="48"
          height="48"
          class="avatar-img"
        />

        <!-- Si no hay foto: mostrar iniciales -->
        <div *ngIf="!fotoUrl || fotoUrl.trim() === ''" class="avatar-iniciales">
          {{ inicial }}
        </div>
      </div>

      <div class="user-block">
        <span class="user-label">Usuario</span>
        <span class="user-name">{{ nombre }}</span>
      </div>
    </a>

    <!-- 游댳 Navegaci칩n -->
    <nav class="nav">
      <a class="nav-item" routerLink="/cliente" routerLinkActive="active">
        <i class="lucide-home"></i><span>Inicio</span>
      </a>

      <a class="nav-item" routerLink="/rutina" routerLinkActive="active">
        <i class="lucide-dumbbell"></i><span>Rutina</span>
      </a>

      <a class="nav-item" routerLink="/mensajes" routerLinkActive="active">
        <i class="lucide-message-square"></i><span>Mensajes</span>
      </a>

      <a class="nav-item" routerLink="/entrenadores" routerLinkActive="active">
        <i class="lucide-users"></i><span>Entrenadores</span>
      </a>

      <a class="nav-item" routerLink="/configuracion" routerLinkActive="active">
        <i class="lucide-settings"></i><span>Configuraci칩n</span>
      </a>
    </nav>

    <button class="logout" type="button" (click)="logout()">
      <i class="lucide-log-out"></i><span>Salir</span>
    </button>
  </aside>

  <!-- ===== CONTENT ===== -->
  <main class="content">
    <header class="topbar">
      <div class="container topbar-inner edge-left">
        <button
          class="hamburger"
          type="button"
          aria-label="Abrir men칰"
          (click)="menuOpen = !menuOpen">
          <i class="lucide-menu"></i>
        </button>

        <form class="search" role="search">
          <i class="lucide-search" aria-hidden="true"></i>
          <input type="search" placeholder="Buscar..." aria-label="Buscar" />
        </form>

        <button class="notif" type="button" aria-label="Notificaciones">
          <i class="lucide-bell" aria-hidden="true"></i>
          <span class="dot" aria-hidden="true"></span>
        </button>

        <!-- Perfil superior -->
        <a
          class="profile"
          aria-label="Abrir perfil"
          routerLink="/perfil"
          routerLinkActive="active">
          <img
            [src]="fotoUrl && fotoUrl.trim() !== '' ? fotoUrl : 'assets/img/default-user.png'"
            width="36"
            height="36"
            alt="Foto de perfil"
            decoding="async"
            fetchpriority="high" />
          <span>{{ nombre }}</span>
        </a>
      </div>
    </header>

    <!-- Hero -->
    <section class="hero" style="--hero-bg: url('/assets/img/fitman-logo.png')">
      <div class="container hero-inner edge-left">
        <h1>El primer paso es el que m치s significa</h1>
        <p class="sub">Construye constancia con peque침as victorias diarias.</p>
        <div class="hero-actions">
          <a routerLink="/rutina" class="btn btn-accent btn-lg btn-glow">
            <i class="lucide-play-circle"></i> Empezar rutina de hoy
          </a>
          <a routerLink="/progreso" class="btn btn-outline-light btn-lg">
            <i class="lucide-activity"></i> Ver progreso
          </a>
        </div>
      </div>
    </section>

    <!-- Cards -->
    <section class="container grid edge-left">
      <article class="card">
        <header>
          <h3>Rutina de hoy</h3><span class="badge">0 min</span>
        </header>
        <ul class="list">
          <li>No hay bloques disponibles.</li>
        </ul>
        <a routerLink="/rutina" class="btn btn-secondary btn-block">Ver detalles</a>
      </article>

      <article class="card">
        <header><h3>Progreso semanal</h3></header>
        <div class="stat">
          <div
            class="ring"
            role="img"
            aria-label="Progreso 0%"
            style="background: conic-gradient(var(--primary) 0%, #1f2530 0)">
            <span>0%</span>
          </div>
          <div>
            <p class="muted">Sesiones completadas</p>
            <p class="strong">0 / 0</p>
          </div>
        </div>
        <a routerLink="/progreso" class="btn btn-secondary btn-block">Abrir reportes</a>
      </article>

      <article class="card">
        <header><h3>Mensajes</h3><span class="badge badge-info">0 nuevos</span></header>
        <p class="muted">No tienes mensajes nuevos.</p>
        <a routerLink="/mensajes" class="btn btn-secondary btn-block">Ver mensajes</a>
      </article>
    </section>
  </main>
</div>
