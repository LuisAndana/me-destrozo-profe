<section class="wrap">
  <!-- Topbar Premium -->
  <header class="topbar container">
    <div class="title">
      <h1 class="upper">{{ nombre }}</h1>
      <span class="chip">
        <span class="dot"></span>
        Entrenador de gimnasio
      </span>
    </div>

    <div class="avatar-stack">
      <div class="avatar">
        <img *ngIf="fotoUrl; else inic" [src]="fotoUrl" alt="Foto" />
        <ng-template #inic>
          <div class="letters">{{ inicial }}</div>
        </ng-template>
      </div>

      <div class="avatar-actions">
        <input
          id="avatarFile"
          type="file"
          class="hidden-file"
          accept="image/*"
          (change)="changeAvatar($event)"
        />
        <label for="avatarFile" class="btn btn-ghost btn-sm">
          <span class="material-icons-outlined">photo_camera</span> Cambiar
        </label>
        <button class="btn btn-danger-ghost btn-sm" (click)="removeAvatar()">
          <span class="material-icons-outlined">close</span> Quitar
        </button>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- SECCIÓN 1: INFORMACIÓN BÁSICA -->
    <article class="card card-hero">
      <header class="card-head">
        <h3><span class="material-icons-outlined">assignment</span> Información Profesional</h3>
      </header>

      <div class="form-grid">
        <div class="form-group span-full">
          <label class="label"><span class="material-icons-outlined">description</span> Resumen Profesional</label>
          <textarea
            class="input textarea"
            rows="4"
            [(ngModel)]="data.resumen"
            placeholder="Tu presentación profesional..."
          ></textarea>
        </div>

        <div class="form-group">
          <label class="label"><span class="material-icons-outlined">fitness_center</span> Especialidad Principal</label>
          <input
            type="text"
            class="input"
            [(ngModel)]="data.especialidad"
            placeholder="Ej: Musculación, Cardio..."
          />
        </div>

        <div class="form-group">
          <label class="label"><span class="material-icons-outlined">calendar_month</span> Años de Experiencia</label>
          <input
            type="number"
            class="input"
            [(ngModel)]="data.experiencia"
            placeholder="0"
          />
        </div>

        <div class="form-group span-full">
          <label class="label"><span class="material-icons-outlined">verified</span> Certificaciones Principales</label>
          <textarea
            class="input textarea"
            rows="3"
            [(ngModel)]="data.certificaciones"
            placeholder="Ej: ACE, ISSA, NASM..."
          ></textarea>
        </div>
      </div>
    </article>

    <!-- SECCIÓN 2: UBICACIÓN Y TARIFA -->
    <div class="grid-single">
      <article class="card card-secondary">
        <header class="card-head-compact">
          <h3><span class="material-icons-outlined">location_on</span> Ubicación y Modalidades</h3>
        </header>

        <div class="form-grid">
          <div class="form-group span-full">
            <label class="label"><span class="material-icons-outlined">location_city</span> Ciudad</label>
            <select class="input" [(ngModel)]="data.ciudad">
              <option value="">Selecciona tu ciudad...</option>
              <option *ngFor="let c of ciudadesDisponibles" [value]="c">{{ c }}</option>
            </select>
          </div>

          <div class="form-group span-full">
            <label class="label"><span class="material-icons-outlined">sports_gymnastics</span> Modalidades de Entrenamiento</label>
            <div class="modalidades-grid">
              <button
                *ngFor="let mod of modalidadesDisponibles"
                type="button"
                class="btn-toggle"
                [class.active]="isModalidadSeleccionada(mod)"
                (click)="toggleModalidad(mod)"
              >
                <span class="material-icons-outlined">
                  {{ mod === 'Online' ? 'computer' : 'fitness_center' }}
                </span>
                {{ mod }}
              </button>
            </div>
          </div>
        </div>
      </article>

      <article class="card card-price">
        <header class="card-head-compact">
          <h3><span class="material-icons-outlined">attach_money</span> Mi Tarifa</h3>
        </header>

        <div class="form-grid">
          <div class="form-group span-full">
            <label class="label">Precio por Sesión</label>
            <div class="price-input">
              <span class="currency">$</span>
              <input
                type="number"
                class="input"
                [(ngModel)]="data.precio"
                placeholder="Ingresa tu tarifa"
              />
              <span class="price-period">/ sesión</span>
            </div>
          </div>
        </div>

        <div class="price-display" *ngIf="data.precio">
          <div class="price-content">
            <span class="price-label">Tarifa</span>
            <span class="price-value">${{ data.precio }}</span>
          </div>
        </div>
      </article>
    </div>

    <!-- SECCIÓN 3: ESPECIALIDADES MÚLTIPLES -->
    <article class="card card-hero">
      <header class="card-head">
        <h3><span class="material-icons-outlined">workspace_premium</span> Especialidades Adicionales</h3>
      </header>

      <div class="especialidades-container">
        <div class="add-especialidad">
          <input
            type="text"
            class="input"
            [(ngModel)]="especialidadTemporal"
            placeholder="Ej: Yoga, Pilates, TRX..."
            (keyup.enter)="agregarEspecialidad()"
          />
          <button
            type="button"
            class="btn btn-accent btn-sm"
            (click)="agregarEspecialidad()"
          >
            <span class="material-icons-outlined">add</span> Agregar
          </button>
        </div>

        <div class="especialidades-list" *ngIf="data.especialidades?.length">
          <span
            *ngFor="let esp of data.especialidades; let i = index"
            class="badge"
          >
            {{ esp }}
            <button
              type="button"
              class="badge-close"
              (click)="eliminarEspecialidad(i)"
            >
              <span class="material-icons-outlined">close</span>
            </button>
          </span>
        </div>
      </div>
    </article>

    <!-- SECCIÓN 4: EDUCACIÓN ✅ NUEVA -->
    <article class="card card-hero">
      <header class="card-head">
        <h3><span class="material-icons-outlined">school</span> Educación Formal</h3>
        <button type="button" class="btn btn-accent btn-sm" (click)="addEdu()">
          <span class="material-icons-outlined">add</span> Agregar Educación
        </button>
      </header>

      <ul class="list" *ngIf="data.educacion?.length; else noEducacion">
        <li *ngFor="let edu of data.educacion; let i = index" class="item">
          <div class="item-body">
            <div class="form-grid">
              <div class="form-group">
                <label class="label">Título</label>
                <input type="text" class="input input-sm" [(ngModel)]="edu.titulo" placeholder="Ej: Licenciatura en Educación Física" />
              </div>
              <div class="form-group">
                <label class="label">Institución</label>
                <input type="text" class="input input-sm" [(ngModel)]="edu.institucion" placeholder="Ej: Universidad Autónoma" />
              </div>
              <div class="form-group">
                <label class="label">Año de inicio</label>
                <input type="text" class="input input-sm" [(ngModel)]="edu.inicio" placeholder="Ej: 2015" />
              </div>
              <div class="form-group">
                <label class="label">Año de finalización</label>
                <input type="text" class="input input-sm" [(ngModel)]="edu.fin" placeholder="Ej: 2019" />
              </div>
              <div class="form-group span-full">
                <label class="label">Descripción</label>
                <textarea class="input textarea-sm" rows="2" [(ngModel)]="edu.descripcion" placeholder="Detalles de tus estudios..."></textarea>
              </div>
              <div class="form-group span-full">
                <label class="label">Evidencia (Certificado, Diploma)</label>
                <input 
                  type="file" 
                  class="input input-sm" 
                  accept="image/*,application/pdf"
                  (change)="onPickFileFor('educacion', i, $event)"
                />
                <small *ngIf="edu.evidenciaUrl" class="text-success">✅ Archivo subido</small>
              </div>
            </div>
          </div>

          <div class="item-actions">
            <button type="button" class="link" (click)="delEdu(i)">
              <span class="material-icons-outlined">delete</span> Eliminar
            </button>
          </div>
        </li>
      </ul>

      <ng-template #noEducacion>
        <p class="empty">
          <span class="material-icons-outlined">school</span>
          No has agregado educación formal aún. ¡Agrega tu información educativa!
        </p>
      </ng-template>
    </article>

    <!-- SECCIÓN 5: DIPLOMAS ✅ NUEVA -->
    <article class="card card-hero">
      <header class="card-head">
        <h3><span class="material-icons-outlined">card_membership</span> Diplomas y Certificaciones</h3>
        <button type="button" class="btn btn-accent btn-sm" (click)="addDiploma()">
          <span class="material-icons-outlined">add</span> Agregar Diploma
        </button>
      </header>

      <ul class="list" *ngIf="data.diplomas?.length; else noDiplomas">
        <li *ngFor="let dip of data.diplomas; let i = index" class="item">
          <div class="item-body">
            <div class="form-grid">
              <div class="form-group">
                <label class="label">Nombre del Diploma/Certificado</label>
                <input type="text" class="input input-sm" [(ngModel)]="dip.titulo" placeholder="Ej: Certificación ISSA" />
              </div>
              <div class="form-group">
                <label class="label">Institución Emisora</label>
                <input type="text" class="input input-sm" [(ngModel)]="dip.institucion" placeholder="Ej: ISSA, NASM, ACE" />
              </div>
              <div class="form-group span-full">
                <label class="label">Fecha de Obtención</label>
                <input type="text" class="input input-sm" [(ngModel)]="dip.fecha" placeholder="Ej: 2020" />
              </div>
              <div class="form-group span-full">
                <label class="label">Evidencia (Certificado, Diploma)</label>
                <input 
                  type="file" 
                  class="input input-sm" 
                  accept="image/*,application/pdf"
                  (change)="onPickFileFor('diplomas', i, $event)"
                />
                <small *ngIf="dip.evidenciaUrl" class="text-success">✅ Archivo subido</small>
              </div>
            </div>
          </div>

          <div class="item-actions">
            <button type="button" class="link" (click)="delDiploma(i)">
              <span class="material-icons-outlined">delete</span> Eliminar
            </button>
          </div>
        </li>
      </ul>

      <ng-template #noDiplomas>
        <p class="empty">
          <span class="material-icons-outlined">card_membership</span>
          No has agregado diplomas o certificaciones aún. ¡Comparte tus logros!
        </p>
      </ng-template>
    </article>

    <!-- SECCIÓN 6: CURSOS ✅ NUEVA -->
    <article class="card card-hero">
      <header class="card-head">
        <h3><span class="material-icons-outlined">library_books</span> Cursos y Capacitaciones</h3>
        <button type="button" class="btn btn-accent btn-sm" (click)="addCurso()">
          <span class="material-icons-outlined">add</span> Agregar Curso
        </button>
      </header>

      <ul class="list" *ngIf="data.cursos?.length; else noCursos">
        <li *ngFor="let cur of data.cursos; let i = index" class="item">
          <div class="item-body">
            <div class="form-grid">
              <div class="form-group">
                <label class="label">Nombre del Curso</label>
                <input type="text" class="input input-sm" [(ngModel)]="cur.titulo" placeholder="Ej: Nutrición Deportiva Avanzada" />
              </div>
              <div class="form-group">
                <label class="label">Institución/Plataforma</label>
                <input type="text" class="input input-sm" [(ngModel)]="cur.institucion" placeholder="Ej: Coursera, Udemy, etc." />
              </div>
              <div class="form-group span-full">
                <label class="label">Fecha de Finalización</label>
                <input type="text" class="input input-sm" [(ngModel)]="cur.fecha" placeholder="Ej: 2021" />
              </div>
              <div class="form-group span-full">
                <label class="label">Evidencia (Certificado, Comprobante)</label>
                <input 
                  type="file" 
                  class="input input-sm" 
                  accept="image/*,application/pdf"
                  (change)="onPickFileFor('cursos', i, $event)"
                />
                <small *ngIf="cur.evidenciaUrl" class="text-success">✅ Archivo subido</small>
              </div>
            </div>
          </div>

          <div class="item-actions">
            <button type="button" class="link" (click)="delCurso(i)">
              <span class="material-icons-outlined">delete</span> Eliminar
            </button>
          </div>
        </li>
      </ul>

      <ng-template #noCursos>
        <p class="empty">
          <span class="material-icons-outlined">library_books</span>
          No has agregado cursos aún. ¡Comparte tu aprendizaje continuo!
        </p>
      </ng-template>
    </article>

    <!-- SECCIÓN 7: LOGROS ✅ NUEVA -->
    <article class="card card-hero">
      <header class="card-head">
        <h3><span class="material-icons-outlined">emoji_events</span> Logros y Reconocimientos</h3>
        <button type="button" class="btn btn-accent btn-sm" (click)="addLogro()">
          <span class="material-icons-outlined">add</span> Agregar Logro
        </button>
      </header>

      <ul class="list" *ngIf="data.logros?.length; else noLogros">
        <li *ngFor="let log of data.logros; let i = index" class="item">
          <div class="item-body">
            <div class="form-grid">
              <div class="form-group">
                <label class="label">Título del Logro</label>
                <input type="text" class="input input-sm" [(ngModel)]="log.titulo" placeholder="Ej: Mejor Entrenador del Año" />
              </div>
              <div class="form-group">
                <label class="label">Año</label>
                <input type="text" class="input input-sm" [(ngModel)]="log.anio" placeholder="Ej: 2023" />
              </div>
              <div class="form-group span-full">
                <label class="label">Descripción</label>
                <textarea class="input textarea-sm" rows="2" [(ngModel)]="log.descripcion" placeholder="Detalla tu logro o reconocimiento..."></textarea>
              </div>
              <div class="form-group span-full">
                <label class="label">Evidencia (Foto, Certificado)</label>
                <input 
                  type="file" 
                  class="input input-sm" 
                  accept="image/*,application/pdf"
                  (change)="onPickFileFor('logros', i, $event)"
                />
                <small *ngIf="log.evidenciaUrl" class="text-success">✅ Archivo subido</small>
              </div>
            </div>
          </div>

          <div class="item-actions">
            <button type="button" class="link" (click)="delLogro(i)">
              <span class="material-icons-outlined">delete</span> Eliminar
            </button>
          </div>
        </li>
      </ul>

      <ng-template #noLogros>
        <p class="empty">
          <span class="material-icons-outlined">emoji_events</span>
          No has agregado logros aún. ¡Destaca tus reconocimientos y logros!
        </p>
      </ng-template>
    </article>
  </main>

  <footer class="actions container">
    <button class="btn btn-ghost" (click)="cancel()">
      <span class="material-icons-outlined">cancel</span> Cancelar
    </button>
    <button class="btn btn-accent" [disabled]="saving" (click)="save()">
      <span class="material-icons-outlined">
        {{ saving ? 'hourglass_top' : 'check' }}
      </span>
      {{ saving ? 'Guardando...' : 'Guardar cambios' }}
    </button>
  </footer>
</section>