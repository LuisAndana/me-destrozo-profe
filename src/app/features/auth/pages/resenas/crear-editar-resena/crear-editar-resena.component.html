<!-- crear-editar-resena.component.html -->
<div class="resena-container">
  <!-- Encabezado -->
  <div class="resena-header">
    <h2 class="resena-titulo">
      {{ modo === 'crear' ? '‚úçÔ∏è Califica a ' : '‚úèÔ∏è Edita tu rese√±a de ' }}{{ nombreEntrenador }}
    </h2>
    <p class="resena-subtitulo">
      {{ modo === 'crear' 
        ? 'Comparte tu experiencia con otros clientes' 
        : 'Actualiza tu calificaci√≥n y comentario' }}
    </p>
  </div>

  <!-- Alertas -->
  <div *ngIf="error" class="alert alert-error">
    <span class="alert-icon">‚ö†Ô∏è</span>
    <span class="alert-text">{{ error }}</span>
  </div>

  <div *ngIf="exito" class="alert alert-success">
    <span class="alert-icon">‚úÖ</span>
    <span class="alert-text">{{ exito }}</span>
  </div>

  <!-- Formulario -->
  <form [formGroup]="formulario" class="resena-form">
    <!-- Secci√≥n de Calificaci√≥n -->
    <div class="form-section">
      <label class="form-label">
        Calificaci√≥n
        <span class="required">*</span>
      </label>
      
      <div class="rating-container">
        <div class="stars-wrapper">
          <button
            *ngFor="let star of estrellas"
            type="button"
            class="star-button"
            [class.active]="formulario.get('calificacion')?.value >= star"
            [class.hover]="calificacionHover >= star"
            (click)="selectCalificacion(star)"
            (mouseenter)="onStarHover(star)"
            (mouseleave)="onStarLeave()"
          >
            ‚òÖ
          </button>
        </div>

        <div class="rating-display">
          <span class="rating-number">{{ formulario.get('calificacion')?.value }}/5</span>
          <span class="rating-text">
            {{ getDescripcionCalificacion(formulario.get('calificacion')?.value) }}
          </span>
        </div>
      </div>

      <p *ngIf="calificacionInvalida" class="field-error">
        La calificaci√≥n es requerida
      </p>
    </div>

    <!-- Secci√≥n de Comentario -->
    <div class="form-section">
      <label class="form-label">
        Comentario
        <span class="required">*</span>
      </label>

      <textarea
        formControlName="comentario"
        class="form-textarea"
        [class.input-error]="comentarioInvalido"
        placeholder="Comparte tu experiencia con este entrenador... (m√≠nimo 10 caracteres)"
        rows="6"
      ></textarea>

      <div class="textarea-info">
        <span class="char-count" [class.warning]="caracteresRestantes < 50">
          {{ caracteresRestantes }} caracteres disponibles
        </span>
      </div>

      <p *ngIf="comentarioInvalido" class="field-error">
        <span *ngIf="formulario.get('comentario')?.errors?.['required']">
          El comentario es requerido
        </span>
        <span *ngIf="formulario.get('comentario')?.errors?.['minlength']">
          M√≠nimo 10 caracteres
        </span>
        <span *ngIf="formulario.get('comentario')?.errors?.['maxlength']">
          M√°ximo 500 caracteres
        </span>
      </p>
    </div>

    <!-- Botones de Acci√≥n -->
    <div class="form-actions">
      <button
        type="button"
        class="btn btn-secondary"
        (click)="cancelar()"
        [disabled]="cargando"
      >
        Cancelar
      </button>

      <button
        type="button"
        class="btn btn-primary"
        (click)="enviar()"
        [disabled]="cargando"
      >
        <span *ngIf="!cargando">
          {{ modo === 'crear' ? 'üì§ Enviar Rese√±a' : 'üíæ Actualizar Rese√±a' }}
        </span>
        <span *ngIf="cargando" class="loading-text">
          Guardando...
        </span>
      </button>
    </div>
  </form>
</div>