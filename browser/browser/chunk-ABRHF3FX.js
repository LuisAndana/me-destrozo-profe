import{a as V}from"./chunk-254SLPBV.js";import{b as T,d as A,g as N,y as B}from"./chunk-T5YDL63U.js";import{e as F}from"./chunk-XCTHI3QZ.js";import{$b as k,Db as x,Eb as b,Fb as I,Ga as v,La as O,Pa as g,Wa as c,Xa as i,Ya as a,Z as C,Za as f,_ as M,ac as R,cc as E,db as P,dc as D,eb as _,gb as s,gc as j,pb as m,qb as d,rb as l,sb as w,tb as y,ub as S,vb as z,wa as r}from"./chunk-VJI5GMUY.js";import"./chunk-FDERIQAA.js";function W(n,o){n&1&&(i(0,"div",11),f(1,"div",12),i(2,"p"),m(3,"Cargando rutinas..."),a()())}function $(n,o){if(n&1&&(i(0,"div",13)(1,"p"),m(2),a()()),n&2){let t=s();r(2),d(t.error)}}function G(n,o){if(n&1&&(i(0,"span"),m(1),a()),n&2){let t=s().$implicit;r(),l("",t.series,"\xD7")}}function L(n,o){if(n&1&&(i(0,"span"),m(1),a()),n&2){let t=s().$implicit;r(),d(t.repeticiones)}}function J(n,o){if(n&1&&(i(0,"span"),m(1),a()),n&2){let t=s().$implicit;r(),l(" | Descanso: ",t.descanso_segundos,"s")}}function U(n,o){if(n&1&&(i(0,"li")(1,"div",31)(2,"strong"),m(3),a(),i(4,"small"),m(5),a()(),i(6,"div",32),g(7,G,2,1,"span",33)(8,L,2,1,"span",33)(9,J,2,1,"span",33),a()()),n&2){let t=o.$implicit;r(3),d(t.nombre),r(2),w("",t.grupo_muscular||"General"," \u2022 ",t.dificultad||"N/A"),r(2),c("ngIf",t.series),r(),c("ngIf",t.repeticiones),r(),c("ngIf",t.descanso_segundos)}}function q(n,o){if(n&1&&(i(0,"div",24)(1,"div",25),f(2,"div",26),i(3,"h3",27),m(4),x(5,"titlecase"),a(),i(6,"p",28),m(7),a()(),i(8,"ul",29),g(9,U,10,6,"li",30),a()()),n&2){let t=o.$implicit;r(4),l("\u{1F4AA} ",b(5,3,t.nombre_dia)),r(3),d(t.descripcion),r(2),c("ngForOf",t.ejercicios)}}function H(n,o){if(n&1){let t=P();i(0,"div",16)(1,"div",17)(2,"div",18)(3,"h2"),m(4),x(5,"titlecase"),a(),i(6,"span",19),m(7),x(8,"date"),a()(),i(9,"p",20),m(10),a(),i(11,"div",21)(12,"span"),m(13),a(),i(14,"span"),m(15),a(),i(16,"span"),m(17),a()()(),i(18,"button",22),_("click",function(){C(t);let p=s(2);return M(p.irProgresionCliente())}),m(19,"\u{1F4C8} Ver Progresi\xF3n "),a(),g(20,q,10,5,"div",23),a()}if(n&2){let t=o.$implicit;r(4),d(b(5,7,t.nombre)),r(3),d(I(8,9,t.fecha_creacion,"EEEE, dd/MM/yyyy")),r(3),d(t.descripcion),r(3),l("Objetivo: ",t.objetivo),r(2),l("Nivel: ",t.nivel),r(2),l("D\xEDas: ",t.dias_semana),r(3),c("ngForOf",t.dias)}}function K(n,o){if(n&1&&(i(0,"div",14),g(1,H,21,12,"div",15),a()),n&2){let t=s();r(),c("ngForOf",t.rutinaFiltrada)}}function Q(n,o){n&1&&(i(0,"div",34)(1,"h3"),m(2,"No tienes rutinas registradas para esta semana"),a(),i(3,"p"),m(4,"Tu entrenador asignar\xE1 tus ejercicios pr\xF3ximamente."),a()())}var Y=class n{constructor(o,t){this.rutinaService=o;this.router=t}rutina=[];rutinaFiltrada=[];cargando=!1;error="";semanaSeleccionada="";idAlumno=null;ngOnInit(){let o=this.rutinaService.obtenerAlumnoSeleccionado();if(o?.id_usuario)this.idAlumno=o.id_usuario;else{let t=localStorage.getItem("usuario");if(t)try{let e=JSON.parse(t);this.idAlumno=e.id_usuario||e.id||null}catch{console.warn("\u26A0\uFE0F Error al parsear el usuario de localStorage")}}this.idAlumno?this.cargarRutina(this.idAlumno):this.error="\u26A0\uFE0F No se ha identificado el alumno actual. Inicia sesi\xF3n nuevamente."}cargarRutina(o){this.cargando=!0,this.error="",this.rutinaService.obtenerRutinasAlumno(o).subscribe({next:t=>{console.log("\u2705 Rutinas obtenidas:",t),this.rutina=this.obtenerRutinasMasRecientesPorDia(t),this.rutinaFiltrada=[...this.rutina],this.cargando=!1},error:t=>{console.error("\u274C Error al obtener rutinas:",t),this.error="\u274C No se pudieron cargar las rutinas. Intenta m\xE1s tarde.",this.cargando=!1}})}filtrarPorSemana(){if(!this.semanaSeleccionada){this.rutinaFiltrada=[...this.rutina];return}let[o,t]=this.semanaSeleccionada.split("-W").map(Number),e=new Date(o,0,(t-1)*7+1),p=new Date(e);p.setDate(e.getDate()+6),this.rutinaFiltrada=this.rutina.filter(u=>{let h=new Date(u.fecha_creacion);return h>=e&&h<=p})}obtenerRutinasMasRecientesPorDia(o){let t={};return o.forEach(e=>{let p=new Date(e.fecha_creacion).toDateString();(!t[p]||new Date(e.fecha_creacion)>new Date(t[p].fecha_creacion))&&(t[p]=e)}),Object.values(t).sort((e,p)=>new Date(p.fecha_creacion).getTime()-new Date(e.fecha_creacion).getTime())}irProgresionCliente(){this.idAlumno&&this.router.navigate(["/progresion-cliente",this.idAlumno])}static \u0275fac=function(t){return new(t||n)(v(V),v(F))};static \u0275cmp=O({type:n,selectors:[["app-rutina"]],decls:18,vars:6,consts:[[1,"rutina-wrapper"],[1,"rutina-header"],[1,"filtros"],["for","semana"],["id","semana","type","week",3,"ngModelChange","change","ngModel"],[3,"click","disabled"],[1,"fa-solid","fa-rotate-right"],["class","estado loading",4,"ngIf"],["class","estado error",4,"ngIf"],["class","rutina-lista",4,"ngIf"],["class","estado sin-datos",4,"ngIf"],[1,"estado","loading"],[1,"spinner"],[1,"estado","error"],[1,"rutina-lista"],["class","rutina-card fade-in",4,"ngFor","ngForOf"],[1,"rutina-card","fade-in"],[1,"card-header"],[1,"titulo-dia"],[1,"fecha"],[1,"descripcion"],[1,"info"],[1,"btn-progreso",3,"click"],["class","dia-section fade-up",4,"ngFor","ngForOf"],[1,"dia-section","fade-up"],[1,"dia-header"],[1,"barra-dia"],[1,"nombre-dia"],[1,"desc-dia"],[1,"ejercicios-lista"],[4,"ngFor","ngForOf"],[1,"ejercicio-info"],[1,"detalles"],[4,"ngIf"],[1,"estado","sin-datos"]],template:function(t,e){t&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1"),m(4,"Mis Rutinas"),a(),i(5,"p"),m(6,"Consulta tus entrenamientos personalizados generados por tu entrenador o IA"),a()(),i(7,"div",2)(8,"label",3),m(9,"Semana:"),a(),i(10,"input",4),z("ngModelChange",function(u){return S(e.semanaSeleccionada,u)||(e.semanaSeleccionada=u),u}),_("change",function(){return e.filtrarPorSemana()}),a(),i(11,"button",5),_("click",function(){return e.cargarRutina(e.idAlumno)}),f(12,"i",6),m(13," Actualizar "),a()()(),g(14,W,4,0,"div",7)(15,$,3,1,"div",8)(16,K,2,1,"div",9)(17,Q,5,0,"div",10),a()),t&2&&(r(10),y("ngModel",e.semanaSeleccionada),r(),c("disabled",!e.idAlumno),r(3),c("ngIf",e.cargando),r(),c("ngIf",e.error&&!e.cargando),r(),c("ngIf",!e.cargando&&e.rutinaFiltrada.length>0),r(),c("ngIf",!e.cargando&&e.rutinaFiltrada.length===0&&!e.error))},dependencies:[j,k,R,B,T,A,N,E,D],styles:['[_nghost-%COMP%]{display:block;width:100%;--fondo: #0a0e1a;--card: #1a1f2e;--card-sec: #232935;--borde: #2a3441;--texto: #e8edf5;--texto-sec: #9ca3af;--azul: #3b82f6;--azul-claro: #60a5fa;--azul-oscuro: #2563eb;--grad: linear-gradient(135deg, #3b82f6, #60a5fa);--hover: #1e2532;--acento: #3b82f6;--sombra: rgba(0, 0, 0, .5)}.rutina-wrapper[_ngcontent-%COMP%]{background-color:var(--fondo)!important;min-height:100vh;padding:2rem 2.5rem;color:var(--texto)!important;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif!important;margin:0;box-sizing:border-box}.rutina-header[_ngcontent-%COMP%]{display:flex!important;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;margin-bottom:2.5rem;gap:1.5rem}.rutina-header[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{flex:1;min-width:300px}.rutina-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem!important;font-weight:700!important;background:var(--grad)!important;-webkit-background-clip:text!important;-webkit-text-fill-color:transparent!important;background-clip:text!important;margin:0 0 .5rem!important;line-height:1.2!important;padding:0!important}.rutina-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--texto-sec)!important;margin:0!important;font-size:.95rem!important;line-height:1.5;padding:0!important}.filtros[_ngcontent-%COMP%]{display:flex!important;align-items:center;gap:.8rem;background:var(--card)!important;border:1px solid var(--borde)!important;padding:1rem 1.4rem!important;border-radius:14px!important;box-shadow:0 4px 12px var(--sombra)!important}.filtros[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--texto-sec)!important;font-weight:500!important;font-size:.9rem!important;margin:0!important;padding:0!important}.filtros[_ngcontent-%COMP%]   input[type=week][_ngcontent-%COMP%]{background:var(--card-sec)!important;border:1px solid var(--borde)!important;color:var(--texto)!important;border-radius:10px!important;padding:.6rem 1rem!important;font-size:.95rem!important;transition:all .3s ease;font-family:inherit}.filtros[_ngcontent-%COMP%]   input[type=week][_ngcontent-%COMP%]:focus{outline:none!important;border-color:var(--azul)!important;box-shadow:0 0 0 3px #3b82f626!important;background:var(--hover)!important}.filtros[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:var(--grad)!important;border:none!important;color:#fff!important;padding:.6rem 1.2rem!important;border-radius:8px!important;font-weight:600!important;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:.5rem;font-family:inherit;font-size:.9rem}.filtros[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 24px #3b82f666!important}.filtros[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.filtros[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.9rem}.estado[_ngcontent-%COMP%]{text-align:center;margin-top:4rem;padding:3rem 2rem;background:var(--card)!important;border:1px solid var(--borde)!important;border-radius:18px!important;color:var(--texto-sec)!important;box-shadow:0 4px 16px var(--sombra)!important}.estado[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--texto)!important;margin:0 0 .5rem!important;font-size:1.3rem!important;font-weight:600!important;padding:0!important}.estado[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0!important;font-size:.95rem!important;line-height:1.5;padding:0!important;color:var(--texto-sec)!important}.spinner[_ngcontent-%COMP%]{border:3px solid var(--card-sec)!important;border-top:3px solid var(--azul)!important;border-radius:50%;width:45px;height:45px;margin:0 auto 1rem;animation:_ngcontent-%COMP%_spin 1s linear infinite}.rutina-lista[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.rutina-card[_ngcontent-%COMP%]{background:var(--card)!important;border:1px solid var(--borde)!important;border-radius:18px!important;padding:2rem 2.5rem!important;box-shadow:0 6px 24px var(--sombra)!important;animation:_ngcontent-%COMP%_fadeIn .6s ease;transition:all .3s ease;margin-bottom:0}.rutina-card[_ngcontent-%COMP%]:hover{border-color:var(--azul)!important;box-shadow:0 8px 32px #3b82f640!important;transform:translateY(-3px)}.card-header[_ngcontent-%COMP%]{border-bottom:1px solid var(--borde)!important;padding-bottom:1.2rem!important;margin-bottom:1.8rem!important}.titulo-dia[_ngcontent-%COMP%]{display:flex!important;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem;margin-bottom:.8rem!important}.titulo-dia[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--azul-claro)!important;font-size:1.6rem!important;font-weight:600!important;margin:0!important;padding:0!important;text-transform:capitalize;background:none!important;-webkit-text-fill-color:var(--azul-claro)!important}.fecha[_ngcontent-%COMP%]{color:var(--texto-sec)!important;font-size:.9rem!important;background:var(--card-sec)!important;padding:.4rem .9rem!important;border-radius:8px!important;border:1px solid var(--borde)!important;white-space:nowrap}.descripcion[_ngcontent-%COMP%]{color:var(--texto-sec)!important;font-size:.95rem!important;margin:0 0 .8rem!important;padding:0!important;line-height:1.6}.info[_ngcontent-%COMP%]{display:flex!important;flex-wrap:wrap;gap:1.5rem;margin:0!important;padding:0!important;color:var(--texto-sec)!important;font-size:.9rem!important;list-style:none}.info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.3rem;color:var(--texto-sec)!important}.info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:before{content:"\\2022  ";color:var(--acento)!important;font-weight:700;font-size:1.2rem}.dia-section[_ngcontent-%COMP%]{background:var(--card-sec)!important;border:1px solid var(--borde)!important;border-radius:14px!important;padding:1.5rem 1.8rem!important;margin-top:1.3rem!important;margin-bottom:0!important;transition:all .3s ease;position:relative;overflow:hidden}.dia-section[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:0;width:4px;height:100%;background:var(--grad);opacity:0;transition:opacity .3s ease}.dia-section[_ngcontent-%COMP%]:hover:before{opacity:1}.dia-section[_ngcontent-%COMP%]:hover{border-color:var(--azul)!important;box-shadow:0 4px 20px #3b82f633!important;transform:translate(4px)}.dia-header[_ngcontent-%COMP%]{margin-bottom:1.2rem!important;padding:0!important}.nombre-dia[_ngcontent-%COMP%]{font-weight:700!important;font-size:1.2rem!important;color:var(--azul-claro)!important;margin:0 0 .5rem!important;padding:0!important;display:flex;align-items:center;gap:.5rem;text-transform:capitalize;background:none!important;-webkit-text-fill-color:var(--azul-claro)!important}.desc-dia[_ngcontent-%COMP%]{color:var(--texto-sec)!important;font-size:.9rem!important;line-height:1.5;margin:0!important;padding:0!important}.ejercicios-lista[_ngcontent-%COMP%]{list-style:none!important;margin:0!important;padding:0!important;display:flex;flex-direction:column;gap:.8rem}.ejercicios-lista[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background:var(--hover)!important;border:1px solid var(--borde)!important;border-radius:10px!important;padding:1rem 1.3rem!important;margin:0!important;display:flex!important;justify-content:space-between;align-items:center;transition:all .25s ease;position:relative;gap:1rem;list-style:none!important}.ejercicios-lista[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:""!important;position:absolute;left:0;top:50%;transform:translateY(-50%);width:3px;height:60%;background:var(--azul)!important;border-radius:0 3px 3px 0;opacity:0;transition:opacity .25s ease}.ejercicios-lista[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover:before{opacity:1}.ejercicios-lista[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:var(--card)!important;border-color:var(--azul-claro)!important;box-shadow:0 4px 16px #3b82f626!important;transform:translate(5px)}.ejercicio-info[_ngcontent-%COMP%]{flex:1;min-width:0}.ejercicio-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#fff!important;font-size:1rem!important;display:block;margin:0 0 .4rem!important;padding:0!important;font-weight:600!important}.ejercicio-info[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:block;color:var(--texto-sec)!important;font-size:.85rem!important;margin:0!important;padding:0!important}.detalles[_ngcontent-%COMP%]{color:var(--azul-claro)!important;font-weight:600!important;font-size:.9rem!important;background:#3b82f61a!important;padding:.4rem .9rem!important;border-radius:8px!important;border:1px solid rgba(59,130,246,.25)!important;white-space:nowrap;flex-shrink:0;margin:0!important}.detalles[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--azul-claro)!important}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 768px){.rutina-wrapper[_ngcontent-%COMP%]{padding:1.5rem 1rem!important}.rutina-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch!important}.rutina-header[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{min-width:100%}.rutina-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem!important}.filtros[_ngcontent-%COMP%]{width:100%;flex-wrap:wrap;justify-content:space-between}.filtros[_ngcontent-%COMP%]   input[type=week][_ngcontent-%COMP%]{flex:1;min-width:150px}.rutina-card[_ngcontent-%COMP%]{padding:1.5rem 1.2rem!important}.titulo-dia[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start!important}.titulo-dia[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.3rem!important}.info[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem!important}.dia-section[_ngcontent-%COMP%]{padding:1.2rem 1rem!important}.ejercicios-lista[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{flex-direction:column!important;align-items:flex-start!important;padding:1rem!important}.detalles[_ngcontent-%COMP%]{align-self:flex-start;font-size:.85rem!important}}@media (max-width: 480px){.rutina-wrapper[_ngcontent-%COMP%]{padding:1rem .8rem!important}.rutina-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.4rem!important}.rutina-card[_ngcontent-%COMP%]{padding:1.2rem 1rem!important}.filtros[_ngcontent-%COMP%]{padding:.6rem .8rem!important}.filtros[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem 1rem!important;font-size:.85rem!important}}']})};export{Y as RutinaComponent};
