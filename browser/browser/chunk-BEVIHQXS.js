import{a as S}from"./chunk-V6EGWKIV.js";import{b as D,c as E,d as T,e as A,h as N,l as V,n as U,x as L,y as $,z as j}from"./chunk-T5YDL63U.js";import{$b as I,Ba as z,K as x,La as O,Pa as p,U as v,Wa as c,Xa as i,Ya as r,Z as g,Za as h,_ as f,ac as P,db as C,eb as _,f as y,gb as d,gc as R,nb as M,pb as s,qb as b,rb as m,sb as w,wa as a}from"./chunk-VJI5GMUY.js";function H(n,e){if(n&1&&(i(0,"div",25)(1,"span",26),s(2,"\u26A0\uFE0F"),r(),i(3,"span",27),s(4),r()()),n&2){let t=d();a(4),b(t.error)}}function J(n,e){if(n&1&&(i(0,"div",28)(1,"span",26),s(2,"\u2705"),r(),i(3,"span",27),s(4),r()()),n&2){let t=d();a(4),b(t.exito)}}function K(n,e){if(n&1){let t=C();i(0,"button",29),_("click",function(){let l=g(t).$implicit,u=d();return f(u.selectCalificacion(l))})("mouseenter",function(){let l=g(t).$implicit,u=d();return f(u.onStarHover(l))})("mouseleave",function(){g(t);let l=d();return f(l.onStarLeave())}),s(1," \u2605 "),r()}if(n&2){let t,o=e.$implicit,l=d();M("active",((t=l.formulario.get("calificacion"))==null?null:t.value)>=o)("hover",l.calificacionHover>=o)}}function Q(n,e){n&1&&(i(0,"p",30),s(1," La calificaci\xF3n es requerida "),r())}function W(n,e){n&1&&(i(0,"span"),s(1," El comentario es requerido "),r())}function X(n,e){n&1&&(i(0,"span"),s(1," M\xEDnimo 10 caracteres "),r())}function Z(n,e){n&1&&(i(0,"span"),s(1," M\xE1ximo 500 caracteres "),r())}function ee(n,e){if(n&1&&(i(0,"p",30),p(1,W,2,0,"span",23)(2,X,2,0,"span",23)(3,Z,2,0,"span",23),r()),n&2){let t,o,l,u=d();a(),c("ngIf",(t=u.formulario.get("comentario"))==null||t.errors==null?null:t.errors.required),a(),c("ngIf",(o=u.formulario.get("comentario"))==null||o.errors==null?null:o.errors.minlength),a(),c("ngIf",(l=u.formulario.get("comentario"))==null||l.errors==null?null:l.errors.maxlength)}}function te(n,e){if(n&1&&(i(0,"span"),s(1),r()),n&2){let t=d();a(),m(" ",t.modo==="crear"?"\u{1F4E4} Enviar Rese\xF1a":"\u{1F4BE} Actualizar Rese\xF1a"," ")}}function ne(n,e){n&1&&(i(0,"span",31),s(1," Guardando... "),r())}var k=class n{idEntrenador;nombreEntrenador="Entrenador";resenaExistente=null;resenaGuardada=new z;cancelado=new z;resenaService=v(S);fb=v(L);destroy$=new y;formulario;cargando=!1;error=null;exito=null;modo="crear";idUsuarioActual;mostrarErrores=!1;calificacionHover=0;caracteresRestantes=500;ngOnInit(){this.obtenerIdUsuario(),this.inicializarFormulario(),this.resenaExistente&&(this.modo="editar",this.cargarDatosExistentes())}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}obtenerIdUsuario(){try{let e=localStorage.getItem("usuario");if(e){let t=JSON.parse(e);this.idUsuarioActual=t.id||t.id_usuario}}catch(e){console.error("Error obteniendo usuario:",e),this.error="Error: No se pudo identificar el usuario"}}inicializarFormulario(){this.formulario=this.fb.group({calificacion:[5,[E.required,E.min(1),E.max(5)]],comentario:["",[E.required,E.minLength(10),E.maxLength(500)]]}),this.formulario.get("comentario")?.valueChanges.pipe(x(this.destroy$)).subscribe(e=>{this.caracteresRestantes=500-(e?.length||0)})}cargarDatosExistentes(){this.resenaExistente&&(this.formulario.patchValue({calificacion:this.resenaExistente.calificacion,comentario:this.resenaExistente.comentario}),this.caracteresRestantes=500-this.resenaExistente.comentario.length)}onStarHover(e){this.calificacionHover=e}onStarLeave(){this.calificacionHover=0}selectCalificacion(e){this.formulario.patchValue({calificacion:e})}get estrellas(){return[1,2,3,4,5]}get calificacionInvalida(){let e=this.formulario.get("calificacion");return!!(e&&e.invalid&&(e.dirty||e.touched||this.mostrarErrores))}get comentarioInvalido(){let e=this.formulario.get("comentario");return!!(e&&e.invalid&&(e.dirty||e.touched||this.mostrarErrores))}enviar(){if(this.error=null,this.exito=null,this.mostrarErrores=!0,this.formulario.invalid){this.error="Por favor, completa todos los campos correctamente";return}this.cargando=!0,this.modo==="crear"?this.crearResena():this.actualizarResena()}crearResena(){let e={id_entrenador:this.idEntrenador,calificacion:this.formulario.get("calificacion")?.value,comentario:this.formulario.get("comentario")?.value};this.resenaService.crearResena(this.idUsuarioActual,e).pipe(x(this.destroy$)).subscribe({next:t=>{this.exito=`\xA1Rese\xF1a creada exitosamente! Calificaci\xF3n: ${t.calificacion}/5`,this.cargando=!1,setTimeout(()=>{this.resenaGuardada.emit(t)},1e3)},error:t=>{this.cargando=!1,this.manejarError(t)}})}actualizarResena(){if(!this.resenaExistente)return;let e={calificacion:this.formulario.get("calificacion")?.value,comentario:this.formulario.get("comentario")?.value};this.resenaService.actualizarResena(this.resenaExistente.id_resena,this.idUsuarioActual,e).pipe(x(this.destroy$)).subscribe({next:t=>{this.exito="\xA1Rese\xF1a actualizada exitosamente!",this.cargando=!1,setTimeout(()=>{this.resenaGuardada.emit(t)},1e3)},error:t=>{this.cargando=!1,this.manejarError(t)}})}cancelar(){this.cancelado.emit()}manejarError(e){console.error("Error:",e),e.status===409?this.error="Ya has calificado a este entrenador. Puedes editar tu rese\xF1a.":e.status===403?this.error="No tienes permiso para realizar esta acci\xF3n":e.status===404?this.error="El entrenador no fue encontrado":e.error?.detail?this.error=e.error.detail:this.error="Error al guardar la rese\xF1a. Intenta nuevamente."}getDescripcionCalificacion(e){return{1:"Malo",2:"Regular",3:"Bueno",4:"Muy Bueno",5:"Excelente"}[e]||""}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=O({type:n,selectors:[["app-crear-editar-resena"]],inputs:{idEntrenador:"idEntrenador",nombreEntrenador:"nombreEntrenador",resenaExistente:"resenaExistente"},outputs:{resenaGuardada:"resenaGuardada",cancelado:"cancelado"},decls:39,vars:20,consts:[[1,"resena-container"],[1,"resena-header"],[1,"resena-titulo"],[1,"resena-subtitulo"],["class","alert alert-error",4,"ngIf"],["class","alert alert-success",4,"ngIf"],[1,"resena-form",3,"formGroup"],[1,"form-section"],[1,"form-label"],[1,"required"],[1,"rating-container"],[1,"stars-wrapper"],["type","button","class","star-button",3,"active","hover","click","mouseenter","mouseleave",4,"ngFor","ngForOf"],[1,"rating-display"],[1,"rating-number"],[1,"rating-text"],["class","field-error",4,"ngIf"],["formControlName","comentario","placeholder","Comparte tu experiencia con este entrenador... (m\xEDnimo 10 caracteres)","rows","6",1,"form-textarea"],[1,"textarea-info"],[1,"char-count"],[1,"form-actions"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[4,"ngIf"],["class","loading-text",4,"ngIf"],[1,"alert","alert-error"],[1,"alert-icon"],[1,"alert-text"],[1,"alert","alert-success"],["type","button",1,"star-button",3,"click","mouseenter","mouseleave"],[1,"field-error"],[1,"loading-text"]],template:function(t,o){if(t&1&&(i(0,"div",0)(1,"div",1)(2,"h2",2),s(3),r(),i(4,"p",3),s(5),r()(),p(6,H,5,1,"div",4)(7,J,5,1,"div",5),i(8,"form",6)(9,"div",7)(10,"label",8),s(11," Calificaci\xF3n "),i(12,"span",9),s(13,"*"),r()(),i(14,"div",10)(15,"div",11),p(16,K,2,4,"button",12),r(),i(17,"div",13)(18,"span",14),s(19),r(),i(20,"span",15),s(21),r()()(),p(22,Q,2,0,"p",16),r(),i(23,"div",7)(24,"label",8),s(25," Comentario "),i(26,"span",9),s(27,"*"),r()(),h(28,"textarea",17),i(29,"div",18)(30,"span",19),s(31),r()(),p(32,ee,4,3,"p",16),r(),i(33,"div",20)(34,"button",21),_("click",function(){return o.cancelar()}),s(35," Cancelar "),r(),i(36,"button",22),_("click",function(){return o.enviar()}),p(37,te,2,1,"span",23)(38,ne,2,0,"span",24),r()()()()),t&2){let l,u;a(3),w(" ",o.modo==="crear"?"\u270D\uFE0F Califica a ":"\u270F\uFE0F Edita tu rese\xF1a de ","",o.nombreEntrenador," "),a(2),m(" ",o.modo==="crear"?"Comparte tu experiencia con otros clientes":"Actualiza tu calificaci\xF3n y comentario"," "),a(),c("ngIf",o.error),a(),c("ngIf",o.exito),a(),c("formGroup",o.formulario),a(8),c("ngForOf",o.estrellas),a(3),m("",(l=o.formulario.get("calificacion"))==null?null:l.value,"/5"),a(2),m(" ",o.getDescripcionCalificacion((u=o.formulario.get("calificacion"))==null?null:u.value)," "),a(),c("ngIf",o.calificacionInvalida),a(6),M("input-error",o.comentarioInvalido),a(2),M("warning",o.caracteresRestantes<50),a(),m(" ",o.caracteresRestantes," caracteres disponibles "),a(),c("ngIf",o.comentarioInvalido),a(2),c("disabled",o.cargando),a(2),c("disabled",o.cargando),a(),c("ngIf",!o.cargando),a(),c("ngIf",o.cargando)}},dependencies:[R,I,P,$,N,D,T,A,j,V,U],styles:['.resena-container[_ngcontent-%COMP%]{background:linear-gradient(135deg,#7c3aed0d,#3b82f60d);border-radius:1rem;padding:2rem;max-width:600px;margin:0 auto;border:1px solid rgba(124,58,237,.1);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.resena-header[_ngcontent-%COMP%]{margin-bottom:2rem}.resena-titulo[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#fff;margin:0 0 .5rem;background:linear-gradient(135deg,#7c3aed,#3b82f6);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.resena-subtitulo[_ngcontent-%COMP%]{font-size:.95rem;color:#9ca3af;margin:0}.alert[_ngcontent-%COMP%]{padding:1rem;border-radius:.5rem;margin-bottom:1.5rem;display:flex;align-items:center;gap:.75rem;font-size:.9rem;animation:_ngcontent-%COMP%_slideIn .3s ease}.alert-error[_ngcontent-%COMP%]{background:#ef44441a;border:1px solid rgba(239,68,68,.3);color:#fca5a5}.alert-success[_ngcontent-%COMP%]{background:#22c55e1a;border:1px solid rgba(34,197,94,.3);color:#86efac}.alert-icon[_ngcontent-%COMP%]{font-size:1.2rem;flex-shrink:0}.alert-text[_ngcontent-%COMP%]{flex:1}.resena-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.form-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.form-label[_ngcontent-%COMP%]{font-weight:600;color:#e5e7eb;font-size:.95rem}.required[_ngcontent-%COMP%]{color:#ef4444;margin-left:.25rem}.rating-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem}.stars-wrapper[_ngcontent-%COMP%]{display:flex;gap:.5rem}.star-button[_ngcontent-%COMP%]{background:none;border:none;font-size:2.5rem;color:#4b5563;cursor:pointer;transition:all .2s ease;padding:.25rem;line-height:1}.star-button[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.star-button.active[_ngcontent-%COMP%], .star-button.hover[_ngcontent-%COMP%]{color:#fbbf24;text-shadow:0 0 10px rgba(251,191,36,.5)}.rating-display[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.rating-number[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#fbbf24}.rating-text[_ngcontent-%COMP%]{font-size:.85rem;color:#9ca3af}.form-textarea[_ngcontent-%COMP%]{background:#1f293780;border:1px solid rgba(75,85,99,.3);border-radius:.5rem;color:#e5e7eb;padding:1rem;font-family:inherit;font-size:.95rem;resize:vertical;transition:all .3s ease}.form-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#7c3aed;background:#1f2937b3;box-shadow:0 0 0 3px #7c3aed1a}.form-textarea[_ngcontent-%COMP%]::placeholder{color:#6b7280}.form-textarea.input-error[_ngcontent-%COMP%]{border-color:#ef4444;background:#ef44440d}.textarea-info[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.char-count[_ngcontent-%COMP%]{font-size:.8rem;color:#9ca3af;transition:color .3s ease}.char-count.warning[_ngcontent-%COMP%]{color:#fbbf24}.field-error[_ngcontent-%COMP%]{font-size:.85rem;color:#fca5a5;margin:0}.form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:1rem}.btn[_ngcontent-%COMP%]{flex:1;padding:.75rem 1.5rem;border:none;border-radius:.5rem;font-weight:600;font-size:.95rem;cursor:pointer;transition:all .3s ease;text-transform:uppercase;letter-spacing:.5px}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#7c3aed,#3b82f6);color:#fff;box-shadow:0 4px 15px #7c3aed4d}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px #7c3aed66}.btn-primary[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.btn-secondary[_ngcontent-%COMP%]{background:#4b556333;color:#d1d5db;border:1px solid rgba(75,85,99,.3)}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#4b55634d;border-color:#4b556380}.loading-text[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem}.loading-text[_ngcontent-%COMP%]:after{content:"";display:inline-block;width:.5rem;height:.5rem;background:currentColor;border-radius:50%;animation:_ngcontent-%COMP%_pulse 1.5s infinite}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:.5}50%{opacity:1}}@media (max-width: 600px){.resena-container[_ngcontent-%COMP%]{padding:1.5rem}.resena-titulo[_ngcontent-%COMP%]{font-size:1.25rem}.rating-container[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.star-button[_ngcontent-%COMP%]{font-size:2rem}.form-actions[_ngcontent-%COMP%]{flex-direction:column}}']})};function re(n,e){n&1&&(i(0,"div",4),h(1,"div",5),i(2,"p"),s(3,"Cargando rese\xF1as y estad\xEDsticas..."),r()())}function ae(n,e){if(n&1&&(i(0,"div",6)(1,"span",7),s(2,"\u26A0\uFE0F"),r(),i(3,"p"),s(4),r()()),n&2){let t=d();a(4),b(t.error)}}function ie(n,e){if(n&1&&(i(0,"div",12)(1,"div",13)(2,"div",14),s(3),r(),i(4,"div",15),s(5,"Calificaci\xF3n Promedio"),r(),i(6,"div",16),s(7),r()(),h(8,"div",17),i(9,"div",13)(10,"div",14),s(11),r(),i(12,"div",15),s(13),r()()()),n&2){let t=d(2);a(3),b(t.estadisticas.promedio_calificacion.toFixed(1)),a(4),m(" ",t.getStars(t.estadisticas.promedio_calificacion)," "),a(4),b(t.estadisticas.total_resenas),a(2),m(" ",t.estadisticas.total_resenas===1?"Rese\xF1a":"Rese\xF1as"," ")}}function oe(n,e){n&1&&(i(0,"div",18)(1,"div",19),s(2,"\u2B50"),r(),i(3,"h3"),s(4,"Sin rese\xF1as a\xFAn"),r(),i(5,"p"),s(6,"S\xE9 el primero en calificar a este entrenador"),r()())}function se(n,e){if(n&1&&(i(0,"div",25)(1,"div",26)(2,"div",27)(3,"div",28),s(4),r(),i(5,"div",29)(6,"h4",30),s(7),r(),i(8,"p",31),s(9),r()()(),i(10,"div",32)(11,"div",33),s(12),r(),i(13,"span",34),s(14),r()()(),i(15,"p",35),s(16),r()()),n&2){let t=e.$implicit,o=d(3);a(4),m(" ",((t.nombreAlumno==null?null:t.nombreAlumno.charAt(0))||"?").toUpperCase()," "),a(3),m(" ",t.nombreAlumno||"Cliente An\xF3nimo"," "),a(2),m(" ",o.formatearFecha(t.fecha_resena)," "),a(3),m(" ",o.getStars(t.calificacion)," "),a(2),m("",t.calificacion,"/5"),a(2),m(" ",t.comentario," ")}}function ce(n,e){if(n&1){let t=C();i(0,"div",36)(1,"button",37),_("click",function(){g(t);let l=d(3);return f(l.paginaAnterior())}),s(2," \u2190 Anterior "),r(),i(3,"div",38),s(4),r(),i(5,"button",37),_("click",function(){g(t);let l=d(3);return f(l.paginaSiguiente())}),s(6," Siguiente \u2192 "),r()()}if(n&2){let t=d(3);a(),c("disabled",t.paginaActual===1),a(3),w(" P\xE1gina ",t.paginaActual," de ",t.totalPaginas," "),a(),c("disabled",t.paginaActual===t.totalPaginas)}}function le(n,e){if(n&1&&(i(0,"div",20)(1,"div",21)(2,"h2"),s(3,"Rese\xF1as de Clientes"),r(),i(4,"span",22),s(5),r()(),p(6,se,17,6,"div",23)(7,ce,7,4,"div",24),r()),n&2){let t=d(2);a(5),m("",t.resenas.length," rese\xF1a(s)"),a(),c("ngForOf",t.resenasPaginadas),a(),c("ngIf",t.totalPaginas>1)}}function de(n,e){if(n&1&&(i(0,"div",8),p(1,ie,14,4,"div",9)(2,oe,7,0,"div",10)(3,le,8,3,"div",11),r()),n&2){let t=d();a(),c("ngIf",t.estadisticas),a(),c("ngIf",t.resenas.length===0),a(),c("ngIf",t.resenas.length>0)}}var F=class n{idEntrenador;limit=10;resenaService=v(S);destroy$=new y;resenas=[];estadisticas=null;cargando=!0;error=null;paginaActual=1;itemsPorPagina=5;ngOnInit(){this.cargarResenasYEstadisticas()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarResenasYEstadisticas(){this.cargando=!0,this.error=null,this.resenaService.obtenerResenasEntrenador(this.idEntrenador,this.limit).pipe(x(this.destroy$)).subscribe({next:e=>{this.resenas=e},error:e=>{console.error("Error cargando rese\xF1as:",e),this.error="No se pudieron cargar las rese\xF1as",this.cargando=!1}}),this.resenaService.obtenerEstadisticasEntrenador(this.idEntrenador).pipe(x(this.destroy$)).subscribe({next:e=>{this.estadisticas=e,this.cargando=!1},error:e=>{console.error("Error cargando estad\xEDsticas:",e),this.cargando=!1}})}get resenasPaginadas(){let e=(this.paginaActual-1)*this.itemsPorPagina,t=e+this.itemsPorPagina;return this.resenas.slice(e,t)}get totalPaginas(){return Math.ceil(this.resenas.length/this.itemsPorPagina)}paginaAnterior(){this.paginaActual>1&&this.paginaActual--}paginaSiguiente(){this.paginaActual<this.totalPaginas&&this.paginaActual++}getColorCalificacion(e){return e>=4.5?"#22c55e":e>=3.5?"#fbbf24":e>=2.5?"#f97316":"#ef4444"}getStars(e){let t=Math.floor(e),o=e%1!==0,l="\u2605".repeat(t);return o&&(l+="\xBD"),l+="\u2606".repeat(5-Math.ceil(e)),l}formatearFecha(e){try{if(!e)return"Fecha no disponible";let t=typeof e=="string"?new Date(e):e;return isNaN(t.getTime())?(console.warn("Fecha inv\xE1lida:",e),"Fecha no disponible"):t.toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}catch(t){return console.error("Error formateando fecha:",t,e),"Fecha no disponible"}}truncarTexto(e,t=150){return e.length<=t?e:e.substring(0,t)+"..."}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=O({type:n,selectors:[["app-listar-resenas"]],inputs:{idEntrenador:"idEntrenador",limit:"limit"},decls:4,vars:3,consts:[[1,"resenas-container"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","resenas-content",4,"ngIf"],[1,"loading-state"],[1,"spinner"],[1,"error-state"],[1,"error-icon"],[1,"resenas-content"],["class","stats-card",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","resenas-list",4,"ngIf"],[1,"stats-card"],[1,"stat-item"],[1,"stat-value"],[1,"stat-label"],[1,"stat-stars"],[1,"stat-divider"],[1,"empty-state"],[1,"empty-icon"],[1,"resenas-list"],[1,"resenas-header"],[1,"resenas-count"],["class","resena-item",4,"ngFor","ngForOf"],["class","pagination",4,"ngIf"],[1,"resena-item"],[1,"resena-header"],[1,"resena-author"],[1,"avatar"],[1,"author-info"],[1,"author-name"],[1,"resena-date"],[1,"resena-rating"],[1,"rating-stars"],[1,"rating-value"],[1,"resena-comment"],[1,"pagination"],[1,"pagination-btn",3,"click","disabled"],[1,"pagination-info"]],template:function(t,o){t&1&&(i(0,"div",0),p(1,re,4,0,"div",1)(2,ae,5,1,"div",2)(3,de,4,3,"div",3),r()),t&2&&(a(),c("ngIf",o.cargando),a(),c("ngIf",o.error&&!o.cargando),a(),c("ngIf",!o.cargando&&!o.error))},dependencies:[R,I,P],styles:["[_nghost-%COMP%]{--color-primary: #7c3aed;--color-secondary: #3b82f6;--color-tertiary: #14b8a6;--color-accent: #fbbf24;--color-bg-dark: #0f172a;--color-bg-card: #1e293b;--color-bg-card-light: rgba(30, 41, 59, .4);--color-border: rgba(75, 85, 99, .2);--color-text-primary: #f1f5f9;--color-text-secondary: #cbd5e1;--color-text-muted: #94a3b8}.resenas-container[_ngcontent-%COMP%]{width:100%;max-width:1000px;margin:0 auto;padding:0 1rem}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem 2rem;text-align:center;color:var(--color-text-muted);background:var(--color-bg-card-light);border-radius:1rem;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid var(--color-border)}.spinner[_ngcontent-%COMP%]{width:3rem;height:3rem;border:3px solid rgba(124,58,237,.2);border-top-color:var(--color-primary);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-state[_ngcontent-%COMP%]{color:#fca5a5}.error-icon[_ngcontent-%COMP%]{font-size:2rem;margin-bottom:.5rem}.resenas-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2.5rem}.stats-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#7c3aed26,#3b82f626);border:1px solid rgba(124,58,237,.25);border-radius:1.25rem;padding:2rem;display:flex;align-items:center;gap:2rem;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);box-shadow:0 8px 32px #0000004d}.stat-item[_ngcontent-%COMP%]{flex:1;text-align:center}.stat-value[_ngcontent-%COMP%]{font-size:3rem;font-weight:800;background:linear-gradient(135deg,var(--color-primary) 0%,var(--color-secondary) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:.5rem}.stat-label[_ngcontent-%COMP%]{font-size:.95rem;color:var(--color-text-muted);font-weight:500}.stat-stars[_ngcontent-%COMP%]{font-size:1.3rem;color:var(--color-accent);margin-top:.75rem;letter-spacing:.3em}.stat-divider[_ngcontent-%COMP%]{width:1px;height:5rem;background:#7c3aed33}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem;color:var(--color-text-muted);background:var(--color-bg-card-light);border-radius:1.25rem;border:1px dashed var(--color-border)}.empty-icon[_ngcontent-%COMP%]{font-size:3.5rem;margin-bottom:1rem;opacity:.6}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.3rem;color:var(--color-text-primary);margin:0 0 .5rem;font-weight:600}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.95rem;color:var(--color-text-muted)}.resenas-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.resenas-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:1.5rem}.resenas-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--color-text-primary);margin:0;font-weight:700}.resenas-count[_ngcontent-%COMP%]{background:#7c3aed33;color:#c4b5fd;padding:.4rem 1rem;border-radius:.75rem;font-size:.85rem;font-weight:700;border:1px solid rgba(124,58,237,.3)}.resena-item[_ngcontent-%COMP%]{background:var(--color-bg-card-light);border:1px solid var(--color-border);border-radius:1rem;padding:1.5rem;transition:all .3s cubic-bezier(.4,0,.2,1)}.resena-item[_ngcontent-%COMP%]:hover{background:#1e293b99;border-color:#7c3aed59;transform:translateY(-4px);box-shadow:0 12px 40px #7c3aed26}.resena-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1rem;gap:1.5rem}.resena-author[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;flex:1}.avatar[_ngcontent-%COMP%]{width:3rem;height:3rem;border-radius:50%;background:linear-gradient(135deg,var(--color-primary) 0%,var(--color-secondary) 100%);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:1.1rem;flex-shrink:0;box-shadow:0 4px 15px #7c3aed4d}.author-info[_ngcontent-%COMP%]{flex:1}.author-name[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:var(--color-text-primary);margin:0 0 .25rem}.resena-date[_ngcontent-%COMP%]{font-size:.8rem;color:var(--color-text-muted);margin:0}.resena-rating[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:.5rem}.rating-stars[_ngcontent-%COMP%]{font-size:1.1rem;color:var(--color-accent);letter-spacing:.15em}.rating-value[_ngcontent-%COMP%]{font-size:.9rem;font-weight:800;color:var(--color-secondary);background:#3b82f61a;padding:.25rem .75rem;border-radius:.5rem;border:1px solid rgba(59,130,246,.2)}.resena-comment[_ngcontent-%COMP%]{color:var(--color-text-secondary);font-size:.95rem;line-height:1.7;margin:0;word-break:break-word;padding-top:.5rem}.pagination[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:1.5rem;padding:2rem 0;margin-top:2rem;border-top:1px solid var(--color-border)}.pagination-btn[_ngcontent-%COMP%]{background:#7c3aed26;border:1px solid rgba(124,58,237,.3);color:#c4b5fd;padding:.75rem 1.25rem;border-radius:.75rem;cursor:pointer;font-weight:700;font-size:.85rem;transition:all .3s ease;text-transform:uppercase;letter-spacing:.05em}.pagination-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#7c3aed40;border-color:var(--color-primary);color:#e9d5ff;box-shadow:0 4px 15px #7c3aed33;transform:translateY(-2px)}.pagination-btn[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.pagination-info[_ngcontent-%COMP%]{color:var(--color-text-muted);font-size:.85rem;font-weight:700;text-transform:uppercase;letter-spacing:.05em}@media (max-width: 768px){.stats-card[_ngcontent-%COMP%]{flex-direction:column;gap:1.5rem;padding:1.5rem}.stat-divider[_ngcontent-%COMP%]{width:4rem;height:1px}.stat-value[_ngcontent-%COMP%]{font-size:2.5rem}.resena-header[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.resena-rating[_ngcontent-%COMP%]{align-items:flex-start;width:100%}.pagination[_ngcontent-%COMP%]{flex-wrap:wrap;gap:1rem}.pagination-btn[_ngcontent-%COMP%]{flex:1;min-width:120px}.resena-item[_ngcontent-%COMP%]{padding:1rem}.avatar[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;font-size:1rem}}@media (max-width: 480px){.resenas-container[_ngcontent-%COMP%]{padding:0 .5rem}.stats-card[_ngcontent-%COMP%]{padding:1rem}.stat-value[_ngcontent-%COMP%]{font-size:2rem}.resenas-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem}.resena-comment[_ngcontent-%COMP%]{font-size:.9rem}}"]})};function me(n,e){if(n&1){let t=C();i(0,"div",5)(1,"button",6),_("click",function(){g(t);let l=d();return f(l.toggleFormulario())}),s(2),r()()}if(n&2){let t=d();a(),M("activo",t.mostrarFormulario),a(),m(" ",t.textoBotonAccion," ")}}function pe(n,e){if(n&1){let t=C();i(0,"div",7)(1,"app-crear-editar-resena",8),_("resenaGuardada",function(l){g(t);let u=d();return f(u.onResenaGuardada(l))})("cancelado",function(){g(t);let l=d();return f(l.onCancelado())}),r()()}if(n&2){let t=d();a(),c("idEntrenador",t.idEntrenador)("nombreEntrenador",t.nombreEntrenador)("resenaExistente",t.miResena)}}function ue(n,e){if(n&1&&(i(0,"div",9)(1,"h2",10),s(2),r(),h(3,"app-listar-resenas",11),r()),n&2){let t=d();a(2),b(t.tituloSeccion),a(),c("idEntrenador",t.idEntrenador)("limit",10)}}function ge(n,e){n&1&&(i(0,"div",12)(1,"div",13),s(2,"\u{1F512}"),r(),i(3,"p"),s(4,"No tienes acceso a esta secci\xF3n"),r()())}var B=class n{idEntrenador;nombreEntrenador="Entrenador";resenaService=v(S);destroy$=new y;idUsuarioActual;rolUsuarioActual="";mostrarFormulario=!1;miResena=null;cargandoMiResena=!1;esCliente=!1;esEntrenador=!1;ngOnInit(){this.obtenerIdUsuario(),this.determinarRol(),this.idEntrenador||(this.idEntrenador=this.idUsuarioActual),this.esCliente&&this.cargarMiResena()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}obtenerIdUsuario(){try{let e=localStorage.getItem("usuario");if(e){let t=JSON.parse(e);this.idUsuarioActual=t.id||t.id_usuario,this.rolUsuarioActual=t.rol||t.userType||""}}catch(e){console.error("Error obteniendo usuario:",e)}}determinarRol(){let e=(this.rolUsuarioActual||"").toLowerCase();console.log("Rol detectado:",e),this.esCliente=e.includes("cliente")||e.includes("client")||e.includes("alumno")||e.includes("student"),this.esEntrenador=e.includes("entrenador")||e.includes("trainer")||e.includes("coach")}cargarMiResena(){!this.idUsuarioActual||!this.esCliente||(this.cargandoMiResena=!0,this.resenaService.obtenerMiResena(this.idEntrenador,this.idUsuarioActual).pipe(x(this.destroy$)).subscribe({next:e=>{this.miResena=e,this.cargandoMiResena=!1,e&&(this.mostrarFormulario=!1)},error:e=>{console.error("Error cargando mi rese\xF1a:",e),this.cargandoMiResena=!1}}))}toggleFormulario(){this.esCliente&&(this.miResena?this.mostrarFormulario=!this.mostrarFormulario:this.mostrarFormulario=!this.mostrarFormulario)}onResenaGuardada(e){this.miResena=e,this.mostrarFormulario=!1,this.cargarMiResena()}onCancelado(){this.mostrarFormulario=!1}get puedeCalificar(){return this.esCliente&&!this.cargandoMiResena}get textoBotonAccion(){return this.miResena?this.mostrarFormulario?"Cancelar":"\u270F\uFE0F Editar mi rese\xF1a":this.mostrarFormulario?"Cancelar":"\u2B50 Califica a este entrenador"}get mostrarSeccionCrear(){return this.esCliente}get mostrarSeccionResenas(){return this.esCliente||this.esEntrenador}get tituloSeccion(){return this.esEntrenador?"Mis Rese\xF1as":"Rese\xF1as y Calificaciones"}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=O({type:n,selectors:[["app-resenas-entrenador"]],inputs:{idEntrenador:"idEntrenador",nombreEntrenador:"nombreEntrenador"},decls:5,vars:4,consts:[[1,"resenas-entrenador-container"],["class","accion-section",4,"ngIf"],["class","formulario-section",4,"ngIf"],["class","resenas-section",4,"ngIf"],["class","acceso-denegado",4,"ngIf"],[1,"accion-section"],[1,"btn-accion",3,"click"],[1,"formulario-section"],[3,"resenaGuardada","cancelado","idEntrenador","nombreEntrenador","resenaExistente"],[1,"resenas-section"],[1,"seccion-titulo"],[3,"idEntrenador","limit"],[1,"acceso-denegado"],[1,"mensaje-icon"]],template:function(t,o){t&1&&(i(0,"div",0),p(1,me,3,3,"div",1)(2,pe,2,3,"div",2)(3,ue,4,3,"div",3)(4,ge,5,0,"div",4),r()),t&2&&(a(),c("ngIf",o.mostrarSeccionCrear&&o.puedeCalificar),a(),c("ngIf",o.mostrarFormulario&&o.mostrarSeccionCrear),a(),c("ngIf",o.mostrarSeccionResenas),a(),c("ngIf",!o.mostrarSeccionResenas))},dependencies:[R,P,k,F],styles:[".resenas-entrenador-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;width:100%;max-width:900px;margin:0 auto}.accion-section[_ngcontent-%COMP%]{display:flex;justify-content:center}.btn-accion[_ngcontent-%COMP%]{background:linear-gradient(135deg,#7c3aed,#3b82f6);color:#fff;border:none;padding:.75rem 2rem;border-radius:.5rem;font-weight:600;font-size:1rem;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 15px #7c3aed4d;text-transform:uppercase;letter-spacing:.5px}.btn-accion[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 20px #7c3aed66}.btn-accion[_ngcontent-%COMP%]:active{transform:translateY(0)}.btn-accion.activo[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#7c3aed)}.formulario-section[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideDown .3s ease;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.resenas-section[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@media (max-width: 600px){.resenas-entrenador-container[_ngcontent-%COMP%]{gap:1.5rem}.btn-accion[_ngcontent-%COMP%]{width:100%;padding:.75rem 1.5rem}}"]})};export{B as a};
