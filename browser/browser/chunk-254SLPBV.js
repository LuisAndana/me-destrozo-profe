import{P as c,T as u,c as o,g as a,lc as l,mc as s,oc as b}from"./chunk-VJI5GMUY.js";var d=class t{constructor(e){this.http=e;this.cargarEjercicios()}apiUrl="http://localhost:8000/api";token=localStorage.getItem("token");alumnoSeleccionadoSubject=new a(null);ejerciciosDb=new a([]);alumnoSeleccionado$=this.alumnoSeleccionadoSubject.asObservable();ejerciciosDb$=this.ejerciciosDb.asObservable();obtenerAlumnos(){let e=this.getHeaders();return new o(r=>{this.http.get(`${this.apiUrl}/cliente-entrenador/mis-clientes`,{headers:e}).subscribe({next:i=>{r.next(i.map(n=>n.cliente)),r.complete()},error:i=>r.error(i)})})}obtenerAlumnoPorId(e){let r=this.getHeaders();return this.http.get(`${this.apiUrl}/usuarios/${e}`,{headers:r})}obtenerEjerciciosDb(){let e=this.getHeaders();return this.http.get(`${this.apiUrl}/ejercicios`,{headers:e})}cargarEjerciciosDb(){this.obtenerEjerciciosDb().subscribe({next:e=>this.ejerciciosDb.next(e),error:e=>console.error("Error ejercicios:",e)})}obtenerEjerciciosPorGrupo(e){let r=this.getHeaders();return this.http.get(`${this.apiUrl}/ejercicios/grupo/${e}`,{headers:r})}obtenerEjerciciosPorDificultad(e){let r=this.getHeaders();return this.http.get(`${this.apiUrl}/ejercicios/dificultad/${e}`,{headers:r})}generarRutinaIA(e,r,i,n,p=1,m=!0){let h={id_cliente:e,objetivos:r,dias:i,nivel:n,grupo_muscular_foco:"general",duracion_meses:p,proveedor:"auto"},g=m?new s().set("activar_vigencia","true"):new s;return this.http.post(`${this.apiUrl}/ia/generar-rutina`,h,{params:g})}guardarRutina(e){let r=this.getHeaders();return e.id_rutina&&e.generada_por==="gemini"?this.actualizarRutina(e.id_rutina,e):this.http.post(`${this.apiUrl}/rutinas`,e,{headers:r})}actualizarRutina(e,r){let i=this.getHeaders();return this.http.put(`${this.apiUrl}/rutinas/${e}`,r,{headers:i})}obtenerRutinasAlumno(e){let r=this.getHeaders();return this.http.get(`${this.apiUrl}/rutinas/alumno/${e}`,{headers:r})}obtenerDetalleRutina(e){let r=this.getHeaders();return this.http.get(`${this.apiUrl}/rutinas/${e}`,{headers:r})}eliminarRutina(e){let r=this.getHeaders();return this.http.delete(`${this.apiUrl}/rutinas/${e}`,{headers:r})}contarEjercicios(e){return e.dias?e.dias.reduce((r,i)=>r+(i.ejercicios?.length??0),0):0}seleccionarAlumno(e){this.alumnoSeleccionadoSubject.next(e)}obtenerAlumnoSeleccionado(){return this.alumnoSeleccionadoSubject.value}obtenerEjerciciosCargados(){return this.ejerciciosDb.value}prepararDatosAlumno(e){return{id_usuario:e.id_usuario,nombre:e.nombre,apellido:e.apellido,edad:e.edad??30,peso:e.peso??70,altura:e.altura??170,imc:e.imc??this.calcularIMC(e.peso??70,e.altura??170)}}calcularIMC(e,r){let i=r/100;return Math.round(e/(i*i)*100)/100}getHeaders(){return new l({Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"})}cargarEjercicios(){this.cargarEjerciciosDb()}static \u0275fac=function(r){return new(r||t)(u(b))};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})};export{d as a};
